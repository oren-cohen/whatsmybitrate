# Whats my Bitrate? - Audio Quality Analyzer

## Overview
This tool analyzes audio files for quality metrics such as bit rate, frequency, and codec type in bulk. It also generates spectrograms for visual representation of the audio spectrum. It supports a variety of audio formats, including MP3, FLAC, WAV, AAC, M4A, and more.

## Features
- Analyze audio files for detailed quality metrics.
- Generate spectrograms for audio visualization.
- Supports multiple file types: `mp3`, `flac`, `wav`, `aac`, `ogg`, `m4a`, `aiff`.
- Batch processing of files in a directory.
- Recursive directory scanning.
- Multi-threaded processing for faster analysis.
- Export results in HTML or CSV format.

## Requirements
- OS X or Linux
- Python 3.7 or later
- FFmpeg (for metadata extraction and file decoding)
- Required Python libraries (see `requirements.txt`)

## Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/oren-cohen/whatsmybitrate.git
   cd whatsmybitrate
   ```

2. Install Python dependencies:
   ```bash
   pip install -r requirements.txt
   ```

3. Install FFmpeg:
   - **Linux**:
     ```bash
     sudo apt update
     sudo apt install ffmpeg
     ```
   - **MacOS**:
     ```bash
     brew install ffmpeg
     ```
   - **Windows**:
     1. Download FFmpeg from [ffmpeg.org](https://ffmpeg.org/download.html).
     2. Extract the archive and add the `bin` folder to your system's PATH.

   To verify FFmpeg installation, run:
   ```bash
   ffmpeg -version
   ```

## Usage
### Basic Command
Analyze all audio files in the current directory and generate a report:
```bash
python whatsmybitrate.py -f report.html -l -a  # For HTML report
python whatsmybitrate.py -f report.csv -l -a   # For CSV report
```
  -h, --help            show this help message and exit

Input & Output Arguments:
  input                 The target for analysis: a single file, a directory, or a shell glob pattern.
  -f FILE, --file FILE  Set the output report file name. The format extension is optional.
  -c, --csv             Output the report in CSV format instead of the default HTML.

File Scanning & Filtering Arguments:
  -t TYPE, --type TYPE  Scan a directory for a single file TYPE (e.g., 'mp3', 'flac').
  -a, --all             Scan a directory for ALL supported audio types.
  -r, --recursive       Scan directories recursively.

Performance & Utility Arguments:
  -m THREADS, --threads THREADS
                        Number of parallel threads to use. Default: 1.
  -n, --no-spectrogram  Disable spectrogram generation in HTML reports.
  -l, --log             Enable verbose logging to a timestamped log file.
### Command-Line Arguments
| Argument                         | Description                                                                                             |
| -------------------------------- | ------------------------------------------------------------------------------------------------------- |
| `--file, -f <file>`              | Set the output report file name. The format extension is optional. Default output is in HTML            |
| `--csv, -c`                      | Output the report in CSV format instead of the default HTML.                                            |
| `--log, -l`                      | Enable logging.                                                                                         |
| `--all, -a`                      | Scan a directory for ALL supported audio types.                                                         |
| `--type <type>, -t`              | Scan a directory for a single file TYPE (e.g., 'mp3', 'flac').                                          |
| `--recursive, -r`                | Scan directories recursively.                                                                           |
| `--threads <threads>, -m`        | Number of parallel threads to use. (Default: 1).                                                        |
| `--no-spectrogram, -n`           | Disable spectrogram generation (spectrograms are generated by default).                                 |
| `<input>`                        | The target for analysis: a single file, a directory, or a shell glob pattern. (e.g., `*.mp3`, `*.wav`). |

When analyzing multiple files, we recommend setting the amount of threads to a higher count that your machine can handle. 

### Examples
1. Analyze all files in a directory recursively:
   ```bash
   python whatsmybitrate.py --all --recursive /path/to/directory  # HTML report
   python whatsmybitrate.py --csv --all --recursive /path/to/directory   # CSV report
   ```

2. Analyze only `mp3` files in a directory recursively:
   ```bash
   python whatsmybitrate.py mp3_analysis.html --type mp3 --recursive  /path/to/directory  # HTML report
   python whatsmybitrate.py --csv mp3_analysis.csv --type mp3 --recursive /path/to/directory   # CSV report
   ```

3. Analyze specific files:
   ```bash
   python whatsmybitrate.py file1.mp3 file2.wav  # HTML report
   python whatsmybitrate.py file1.mp3 file2.wav   # CSV report
   ```
### Example of re-encoded 128kbps MP3
![image](https://github.com/user-attachments/assets/1c6e089a-b934-41f3-84fb-e07855121b54)

## Supported Audio Formats
- WAV
- FLAC
- MP3
- AAC
- OGG
- M4A
- AIFF

## Output
The script can generate reports in two formats:

- **HTML Report** (use `.html` extension): Contains detailed metrics for each file, including:
  - Codec
  - Sample Rate
  - Max Frequency
  - Nyquist Frequency
  - Frequency Ratio
  - Stated Bit Rate
  - Estimated Bitrate
  - Spectrogram image (if generated)

- **CSV Report** (use `.csv` extension): Contains the same metrics in a tabular format suitable for:
  - Importing into spreadsheet software
  - Data analysis and processing
  - Integration with other tools
  
Note: CSV reports exclude spectrograms as they cannot be represented in CSV format.

## Troubleshooting
### FFmpeg Not Found
Ensure FFmpeg is installed and added to your system's PATH. Test the installation by running:
```bash
ffmpeg -version
```

### Missing Spectrograms
If spectrograms are missing:
- Ensure `matplotlib` and `librosa` are installed:
  ```bash
  pip install matplotlib librosa
  ```
- Check that the audio file is not corrupt or unsupported.

### Errors in Logs
If the script encounters errors, enable logging with the `-l` flag. Review the logs for detailed error messages.


## License
MIT

---

If you encounter any issues, feel free to open an issue on the GitHub repository.
